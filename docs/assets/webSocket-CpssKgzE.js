import{a as v,c as n,C as a,g as s}from"./server-qp9O8Bzm.js";import{d as r,f as p,p as c,a as E}from"./helper-B6ldCULI.js";import"./modules/vue-CHNgrS5A.js";import"./index-BpXkDZzU.js";import"./modules/shiki-B4CAAHVZ.js";let d,t;function N(e){const{data:i,type:f}=JSON.parse(e.data);f==="poll"?Object.entries(i).forEach(([o,l])=>c[o]=l):Object.entries(i).forEach(([o,l])=>E[o]=l)}function u(){s.value&&(t.send(JSON.stringify({id:s.value,state:c,type:"connect"})),n.value=a.CONNECTED,d())}function S(){n.value===a.IDLE?n.value=a.ERROR:n.value=a.DISCONNECTED}function C(){t?u():(t=new WebSocket(p()),t.addEventListener("message",N),t.addEventListener("open",u),t.addEventListener("close",S))}function D(e){v.value=new Date().toISOString(),C(),d=e}function J(e,i){n.value===a.CONNECTED&&t.send(JSON.stringify({id:s.value,pollId:e,status:i,type:"status"}))}function T(e){n.value===a.CONNECTED&&t.send(JSON.stringify({id:s.value,pollId:e,type:"reset"}))}function b(e,i){n.value===a.CONNECTED&&t.send(JSON.stringify({id:s.value,pollId:e,result:i,type:"answer",userId:r.value}))}function w(e){n.value===a.CONNECTED&&t.send(JSON.stringify({id:s.value,userId:r.value,userName:e,type:"login"}))}export{b as answer,D as connect,w as login,T as reset,J as setStatus};
