import{a as p,c as n,C as a,g as o}from"./server-CcfGgIFB.js";import{d as u,f as v,p as c,a as E}from"./helper-CB-FUlq3.js";import"./modules/vue-rRtXEXxZ.js";import"./index-CH1IIRn0.js";import"./modules/shiki-B49DkA4F.js";import"./hashids-CTCUm3b4.js";let d,t;function N(e){const{data:i,type:f}=JSON.parse(e.data);f==="poll"?Object.entries(i).forEach(([s,l])=>c[s]=l):Object.entries(i).forEach(([s,l])=>E[s]=l)}function r(){o.value&&(t.send(JSON.stringify({id:o.value,state:c,type:"connect"})),n.value=a.CONNECTED,d())}function S(){n.value===a.IDLE?n.value=a.ERROR:n.value=a.DISCONNECTED}function C(){t?r():(t=new WebSocket(v()),t.addEventListener("message",N),t.addEventListener("open",r),t.addEventListener("close",S))}function J(e){p.value=new Date().toISOString(),C(),d=e}function T(e,i){n.value===a.CONNECTED&&t.send(JSON.stringify({id:o.value,pollId:e,status:i,type:"status"}))}function b(e){n.value===a.CONNECTED&&t.send(JSON.stringify({id:o.value,pollId:e,type:"reset"}))}function w(e,i){n.value===a.CONNECTED&&t.send(JSON.stringify({id:o.value,pollId:e,result:i,type:"answer",userId:u.value}))}function L(e){n.value===a.CONNECTED&&t.send(JSON.stringify({id:o.value,userId:u.value,userName:e,type:"login"}))}export{w as answer,J as connect,L as login,b as reset,T as setStatus};
